diff --git a/epan/dissectors/packet-megaco.c b/epan/dissectors/packet-megaco.c
index f23e9a0..0100be4 100644
--- a/epan/dissectors/packet-megaco.c
+++ b/epan/dissectors/packet-megaco.c
@@ -3296,7 +3296,7 @@ static void tvb_raw_text_add(tvbuff_t *tvb, proto_tree *tree){
                             "%s", tvb_format_text_wsp(tvb,tvb_linebegin,
                                                       linelen));
         tvb_linebegin = tvb_lineend;
-    } while ( tvb_lineend < tvb_len );
+    } while ( tvb_lineend < tvb_len && linelen > 0);
 }
 
 /*
