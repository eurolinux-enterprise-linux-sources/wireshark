From 85441817e9068de1267e945cfee1f8080c402fa7 Mon Sep 17 00:00:00 2001
From: Martin Sehnoutka <msehnout@redhat.com>
Date: Mon, 13 Mar 2017 10:38:54 +0100
Subject: [PATCH] Backport dissect_gmr1_bcch modifications from upstream.

---
 epan/dissectors/packet-gmr1_bcch.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/epan/dissectors/packet-gmr1_bcch.c b/epan/dissectors/packet-gmr1_bcch.c
index f522bd2..6e9a6ed 100644
--- a/epan/dissectors/packet-gmr1_bcch.c
+++ b/epan/dissectors/packet-gmr1_bcch.c
@@ -1048,6 +1048,7 @@ dissect_gmr1_bcch(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)
 	if (is_si1) {
 		SystemInformation1_t *data;
 		data = ep_new(SystemInformation1_t);
+                data->SegmentType = array_length(SI1_SegmentChoice) - 1;
 		csnStreamDissector(bcch_tree, &ar, CSNDESCR(SystemInformation1_t), tvb, data, ett_gmr1_bcch);
 		col_append_fstr(
 			pinfo->cinfo, COL_INFO,
@@ -1057,6 +1058,7 @@ dissect_gmr1_bcch(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)
 	} else {
 		SystemInformation2_t *data;
 		data = ep_new(SystemInformation2_t);
+                data->SegmentType = array_length(SI2_SegmentChoice) - 1;
 		csnStreamDissector(bcch_tree, &ar, CSNDESCR(SystemInformation2_t), tvb, data, ett_gmr1_bcch);
 		col_append_fstr(
 			pinfo->cinfo, COL_INFO,
-- 
2.9.3

