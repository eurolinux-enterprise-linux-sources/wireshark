From cdb4a8e63247c9640f3c7eb62a66fb2b9169fa73 Mon Sep 17 00:00:00 2001
From: Martin Sehnoutka <msehnout@redhat.com>
Date: Fri, 11 Nov 2016 12:53:44 +0100
Subject: [PATCH] Backport dissect_gmr1_bcch modifications from upstream.

---
 epan/dissectors/packet-gmr1_bcch.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/epan/dissectors/packet-gmr1_bcch.c b/epan/dissectors/packet-gmr1_bcch.c
index 0b3f040..fb39737 100644
--- a/epan/dissectors/packet-gmr1_bcch.c
+++ b/epan/dissectors/packet-gmr1_bcch.c
@@ -1050,6 +1050,7 @@ dissect_gmr1_bcch(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)
 	if (is_si1) {
 		SystemInformation1_t *data;
 		data = ep_alloc(sizeof(SystemInformation1_t));
+                data->SegmentType = array_length(SI1_SegmentChoice) - 1;
 		csnStreamDissector(bcch_tree, &ar, CSNDESCR(SystemInformation1_t), tvb, data, ett_gmr1_bcch);
 		col_append_fstr(
 			pinfo->cinfo, COL_INFO,
@@ -1059,6 +1060,7 @@ dissect_gmr1_bcch(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)
 	} else {
 		SystemInformation2_t *data;
 		data = ep_alloc(sizeof(SystemInformation2_t));
+                data->SegmentType = array_length(SI2_SegmentChoice) - 1;
 		csnStreamDissector(bcch_tree, &ar, CSNDESCR(SystemInformation2_t), tvb, data, ett_gmr1_bcch);
 		col_append_fstr(
 			pinfo->cinfo, COL_INFO,
-- 
2.7.4

