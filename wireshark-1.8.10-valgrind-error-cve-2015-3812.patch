From e21f534f94306dcf04b8afa9ffb5f158c9684de2 Mon Sep 17 00:00:00 2001
From: Martin Sehnoutka <msehnout@redhat.com>
Date: Fri, 11 Nov 2016 08:54:25 +0100
Subject: [PATCH 2/2] Fix error discovered by Valgrind:

"Conditional jump or move depends on uninitialised value(s)"
---
 epan/dissectors/packet-distcc.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/epan/dissectors/packet-distcc.c b/epan/dissectors/packet-distcc.c
index ffd29b6..dbc7ae2 100644
--- a/epan/dissectors/packet-distcc.c
+++ b/epan/dissectors/packet-distcc.c
@@ -269,6 +269,7 @@ dissect_distcc(tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree)
     proto_tree *tree=NULL;
     proto_item *item=NULL;
     char token[4];
+    char paramstr[8 + 1];
     guint32 parameter;
 
 
@@ -294,7 +295,9 @@ dissect_distcc(tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree)
         offset+=4;
 
         /* read the parameter */
-        if (sscanf(tvb_get_ptr(tvb, offset, 8), "%08x", &parameter) != 1)
+        tvb_memcpy(tvb, paramstr, offset, 8);
+        paramstr[8] = '\0';
+        if (sscanf(paramstr, "%08x", &parameter) != 1)
             return;
         offset+=8;
 
-- 
2.7.4

